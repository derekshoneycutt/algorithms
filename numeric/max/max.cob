       IDENTIFICATION DIVISION.
       PROGRAM-ID. MAIN.

       DATA DIVISION.
         WORKING-STORAGE SECTION.
         01 ARG-RAW PIC X(10).
         01 ARG-NUM PIC 9.

         01 ARRAY-SIZE PIC 9(4) VALUE 0.
         01 ARRAY-PTR USAGE POINTER.

         01 N PIC 9(4) VALUE 0.
         01 MAXVALUE PIC 9(4) VALUE 0.
         01 OUTVALUE PIC Z(1)9.

         LINKAGE SECTION.
         01 INTEGER-ARRAY BASED.
           05 INTEGER-ITEM PIC 9(4) OCCURS 1 TO 100 TIMES
                                   DEPENDING ON ARRAY-SIZE.

       PROCEDURE DIVISION.
           ACCEPT ARG-NUM FROM ARGUMENT-NUMBER.
           IF ARG-NUM >= 1
             MOVE ARG-NUM TO ARRAY-SIZE
             ALLOCATE INTEGER-ARRAY INITIALIZED RETURNING ARRAY-PTR
             SET ADDRESS OF INTEGER-ARRAY TO ARRAY-PTR

             PERFORM VARYING N FROM 1 BY 1 UNTIL N > ARG-NUM
               ACCEPT ARG-RAW FROM ARGUMENT-VALUE
               MOVE FUNCTION NUMVAL(ARG-RAW) TO INTEGER-ITEM(N)
             END-PERFORM
           ELSE
             MOVE 2 TO ARRAY-SIZE
             ALLOCATE INTEGER-ARRAY INITIALIZED RETURNING ARRAY-PTR
             SET ADDRESS OF INTEGER-ARRAY TO ARRAY-PTR

             MOVE 15 TO INTEGER-ITEM(1)
             MOVE 10 TO INTEGER-ITEM(2)
           END-IF

           CALL 'MAXVALUE' USING ARRAY-PTR, ARRAY-SIZE, MAXVALUE.

           DISPLAY "values:"
           PERFORM VARYING N FROM 1 BY 1 UNTIL N > ARRAY-SIZE
             MOVE FUNCTION TRIM(INTEGER-ITEM(N)) TO OUTVALUE
             DISPLAY OUTVALUE
           END-PERFORM.

           MOVE FUNCTION TRIM(MAXVALUE) TO OUTVALUE.
           DISPLAY 'max:' OUTVALUE.

           FREE ARRAY-PTR.
           SET ARRAY-PTR TO NULL.
           STOP RUN.

       END PROGRAM MAIN.

       IDENTIFICATION DIVISION.
       PROGRAM-ID. MAXVALUE.

       DATA DIVISION.
         WORKING-STORAGE SECTION.
         01 COUNTER PIC 9(4).
         LINKAGE SECTION.
         01 FINALVALUE PIC 9(4).
         01 ARRAY-PTR USAGE POINTER.
         01 ARRAY-SIZE PIC 9(4).

         01 INTEGER-ARRAY BASED.
           05 INTEGER-ITEM PIC 9(4) OCCURS 1 TO 100 TIMES
                                   DEPENDING ON ARRAY-SIZE.

       PROCEDURE DIVISION USING ARRAY-PTR, ARRAY-SIZE, FINALVALUE.
           SET ADDRESS OF INTEGER-ARRAY TO ARRAY-PTR.
           
           MOVE 0 to FINALVALUE.
           PERFORM VARYING COUNTER FROM 1 BY 1
                                   UNTIL COUNTER > ARRAY-SIZE
               IF INTEGER-ITEM(COUNTER) > FINALVALUE THEN
                   MOVE INTEGER-ITEM(COUNTER) TO FINALVALUE
               END-IF
           END-PERFORM.

           EXIT PROGRAM.

       END PROGRAM MAXVALUE.
